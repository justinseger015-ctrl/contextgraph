# TASK-M02-007: Define Domain Enum (Marblestone)

```xml
<task_spec id="TASK-M02-007" version="1.0">
<metadata>
  <title>Define Domain Enum (Marblestone)</title>
  <status>ready</status>
  <layer>foundation</layer>
  <module>module-02</module>
  <sequence>7</sequence>
  <priority>high</priority>
  <estimated_hours>1</estimated_hours>
  <implements>
    <item>TECH-CORE-002 Section 2.5: Marblestone Domain specification</item>
    <item>Marblestone Integration Spec: Context-aware neurotransmitter weighting</item>
  </implements>
  <depends_on>
    <!-- No dependencies - this is a foundation task -->
  </depends_on>
  <estimated_complexity>low</estimated_complexity>
</metadata>

<context>
The Domain enum is part of the Marblestone architecture integration, providing context-aware neurotransmitter weighting based on the knowledge domain. Different domains (Code, Legal, Medical, Creative, Research, General) have different optimal neurotransmitter profiles that affect edge weights and retrieval behavior. This enum enables domain-specific graph traversal optimization.
</context>

<input_context_files>
  <file purpose="Constitution reference for Marblestone edge model">docs2/constitution.yaml</file>
  <file purpose="PRD reference for domain profiles">docs2/contextprd.md</file>
</input_context_files>

<prerequisites>
  <check>crates/context-graph-core directory exists</check>
</prerequisites>

<scope>
  <in_scope>
    - Domain enum with 6 variants: Code, Legal, Medical, Creative, Research, General
    - Domain-specific descriptions
    - Default trait implementation (returns General)
    - Display trait implementation
    - Serde Serialize/Deserialize derives with lowercase names
    - Clone, Copy, Debug, PartialEq, Eq, Hash derives
    - Unit tests
  </in_scope>
  <out_of_scope>
    - NeurotransmitterWeights struct (handled in TASK-M02-008)
    - GraphEdge struct (handled in TASK-M02-010)
  </out_of_scope>
</scope>

<definition_of_done>
  <signatures>
    <signature file="crates/context-graph-core/src/marblestone.rs">
use serde::{Deserialize, Serialize};

/// Knowledge domain for context-aware neurotransmitter weighting.
///
/// Different domains have different optimal retrieval characteristics:
/// - Code: High precision, structured relationships
/// - Legal: High inhibition, careful reasoning
/// - Medical: High causal awareness, evidence-based
/// - Creative: High exploration, associative connections
/// - Research: Balanced exploration and precision
/// - General: Default balanced profile
#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum Domain {
    /// Programming and software development context.
    Code,
    /// Legal documents and reasoning context.
    Legal,
    /// Medical and healthcare context.
    Medical,
    /// Creative writing and artistic context.
    Creative,
    /// Academic research context.
    Research,
    /// General purpose context.
    General,
}

impl Domain {
    /// Returns a human-readable description of this domain's characteristics.
    pub fn description(&amp;self) -> &amp;'static str;

    /// Returns all domain variants as an array.
    pub fn all() -> [Domain; 6];
}

impl Default for Domain {
    fn default() -> Self;
}

impl std::fmt::Display for Domain {
    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -> std::fmt::Result;
}
    </signature>
  </signatures>

  <constraints>
    - Serde serialization must use snake_case (lowercase)
    - Default returns General (the most balanced profile)
    - Copy trait for efficiency (enum is small)
    - Module file must not exceed 500 lines (excluding tests)
  </constraints>

  <verification>
    - cargo build --package context-graph-core compiles without errors
    - cargo test --package context-graph-core domain passes all tests
    - cargo clippy --package context-graph-core shows no warnings
  </verification>
</definition_of_done>

<pseudo_code>
marblestone.rs:
  // Module documentation for Marblestone architecture integration
  // Imports: serde

  // Domain enum with derives
  #[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]
  #[serde(rename_all = "snake_case")]
  pub enum Domain {
    Code,
    Legal,
    Medical,
    Creative,
    Research,
    General,
  }

  impl Domain:
    fn description(&amp;self):
      match self:
        Code => "High precision, structured relationships, strong type awareness"
        Legal => "High inhibition, careful reasoning, precedent-based"
        Medical => "High causal awareness, evidence-based, risk-conscious"
        Creative => "High exploration, associative connections, novelty-seeking"
        Research => "Balanced exploration and precision, citation-aware"
        General => "Default balanced profile for mixed contexts"

    fn all():
      [Code, Legal, Medical, Creative, Research, General]

  impl Default: General

  impl Display:
    write the variant name in lowercase

#[cfg(test)]
mod domain_tests:
  test_default_is_general()
  test_description_non_empty()
  test_all_returns_6_variants()
  test_serde_lowercase()
  test_display()
</pseudo_code>

<files_to_create>
  <file path="crates/context-graph-core/src/marblestone.rs">Domain enum (Marblestone module)</file>
</files_to_create>

<files_to_modify>
  <file path="crates/context-graph-core/src/lib.rs">Add pub mod marblestone; and re-export Domain</file>
</files_to_modify>

<validation_criteria>
  <criterion>Domain enum compiles with 6 variants: Code, Legal, Medical, Creative, Research, General</criterion>
  <criterion>Default implementation returns General</criterion>
  <criterion>Serde serialization uses lowercase names (e.g., "code", not "Code")</criterion>
  <criterion>description() returns non-empty strings for all variants</criterion>
  <criterion>all() returns array containing all 6 variants</criterion>
  <criterion>Copy trait is implemented for efficiency</criterion>
</validation_criteria>

<test_commands>
  <command>cargo build --package context-graph-core</command>
  <command>cargo test --package context-graph-core domain -- --nocapture</command>
  <command>cargo clippy --package context-graph-core -- -D warnings</command>
</test_commands>
</task_spec>
```

## Implementation Notes

### Marblestone Architecture Reference
From constitution.yaml edge_model.nt_weights:
```yaml
domain: Code|Legal|Medical|Creative|Research|General
```

### Domain Characteristics (from PRD)
| Domain | Excitatory | Inhibitory | Modulatory | Behavior |
|--------|------------|------------|------------|----------|
| Code | 0.6 | 0.3 | 0.4 | Precise, structured |
| Legal | 0.4 | 0.4 | 0.2 | Careful, precedent |
| Medical | 0.5 | 0.3 | 0.5 | Causal, evidence |
| Creative | 0.8 | 0.1 | 0.6 | Exploratory |
| Research | 0.6 | 0.2 | 0.5 | Balanced |
| General | 0.5 | 0.2 | 0.3 | Default |

These profiles are implemented in TASK-M02-008 (NeurotransmitterWeights).

---

*Task ID: TASK-M02-007*
*Module: 02 - Core Infrastructure*
*Layer: Foundation*
