# M05-T41: Implement Neuromodulation Interface Stubs for Module 10

## Task Metadata
- **ID**: M05-T41
- **Title**: Implement Neuromodulation Interface Stubs for Module 10
- **Module**: 05 - UTL Integration
- **Layer**: integration
- **Priority**: medium
- **Estimated Hours**: 2
- **Created**: 2026-01-04
- **Status**: pending

## Description

Create neuromodulation interface stubs that Module 10 will implement. Per constitution.yaml neuromod section:
- **Acetylcholine**: maps to utl.lr (learning rate) in [0.001, 0.002]
- **Dopamine**: maps to hopfield.beta (retrieval sharpness)
- **Serotonin**: maps to fuse_moe.top_k (expert diversity)
- **Noradrenaline**: maps to attention.temp (attention distribution)

Create NeuromodulatorInterface trait with:
- `get_learning_rate_modulation() -> f32`
- `get_retrieval_sharpness() -> f32`
- `notify_utl_update(learning_signal: &LearningSignal)`

Stub implementation returns default values until Module 10.

## File Paths

### Implementation
- `crates/context-graph-utl/src/neuromod/interface.rs`

### Tests
- `crates/context-graph-utl/tests/neuromod_interface_tests.rs`

## Dependencies

| Task ID | Title | Status |
|---------|-------|--------|
| M05-T22 | Implement UtlProcessor | pending |
| M05-T36 | Implement Steering Subsystem Hooks | pending |

## Acceptance Criteria

- [ ] NeuromodulatorInterface trait defined
- [ ] Acetylcholine modulates UTL learning rate
- [ ] Stub implementation returns spec defaults
- [ ] notify_utl_update() called after each computation
- [ ] Interface ready for Module 10 implementation
- [ ] Trait object compatible (dyn NeuromodulatorInterface)

## Specification References

- `constitution.yaml neuromod section`
- `PRD Section 3.5 (Neuromodulation)`

## Implementation Notes

### Neuromodulator Mappings (constitution.yaml)

```yaml
neuromod:
  acetylcholine:
    target: utl.lr
    range: [0.001, 0.002]
  dopamine:
    target: hopfield.beta
    effect: retrieval_sharpness
  serotonin:
    target: fuse_moe.top_k
    effect: expert_diversity
  noradrenaline:
    target: attention.temp
    effect: attention_distribution
```

### Interface Definition

```rust
/// Neuromodulator interface for Module 10 integration
/// Trait object compatible for dynamic dispatch
pub trait NeuromodulatorInterface: Send + Sync {
    /// Get current learning rate modulation from acetylcholine
    /// Returns value in [0.001, 0.002] range
    fn get_learning_rate_modulation(&self) -> f32;

    /// Get retrieval sharpness from dopamine
    /// Higher values = sharper retrieval
    fn get_retrieval_sharpness(&self) -> f32;

    /// Get expert diversity from serotonin
    /// Affects fuse_moe.top_k selection
    fn get_expert_diversity(&self) -> u32;

    /// Get attention temperature from noradrenaline
    fn get_attention_temperature(&self) -> f32;

    /// Notify neuromodulation system of UTL update
    /// Called after each UTL computation
    fn notify_utl_update(&mut self, learning_signal: &LearningSignal);
}
```

### Stub Implementation

```rust
/// Default stub implementation until Module 10
pub struct NeuromodulatorStub {
    // Internal state for tracking
}

impl NeuromodulatorInterface for NeuromodulatorStub {
    fn get_learning_rate_modulation(&self) -> f32 {
        0.0015  // Midpoint of [0.001, 0.002]
    }

    fn get_retrieval_sharpness(&self) -> f32 {
        1.0  // Default beta
    }

    fn get_expert_diversity(&self) -> u32 {
        3  // Default top_k
    }

    fn get_attention_temperature(&self) -> f32 {
        1.0  // Default temperature
    }

    fn notify_utl_update(&mut self, _learning_signal: &LearningSignal) {
        // No-op until Module 10
    }
}
```

### Integration Points

- UtlProcessor calls `notify_utl_update()` after each computation
- LifecycleManager may query learning rate modulation
- Future: Dopamine affects steering rewards

## Testing Requirements

1. **Unit Tests**
   - Test stub returns default values
   - Test trait object compatibility
   - Test notify_utl_update is callable

2. **Integration Tests**
   - Test UtlProcessor integration
   - Test learning rate range validation
   - Verify stub has no side effects

3. **Interface Tests**
   - Test trait is Send + Sync
   - Test can be used as dyn NeuromodulatorInterface
   - Test Box<dyn NeuromodulatorInterface> works

## Module 10 Handoff Notes

Module 10 will implement:
- Full neuromodulator state tracking
- Acetylcholine-based learning rate adaptation
- Dopamine-driven reward signals
- Cross-session neuromodulator persistence

---

*Task specification generated for Module 05 - UTL Integration*
