# TASK-EMB-010: Create Golden Reference Fixtures

<task_spec id="TASK-EMB-010" version="1.0">

## Metadata

| Field | Value |
|-------|-------|
| **Task ID** | TASK-EMB-010 |
| **Title** | Create Golden Reference Test Fixtures |
| **Status** | ready |
| **Layer** | foundation |
| **Sequence** | 10 (parallel with others) |
| **Implements** | REQ-EMB-003 |
| **Depends On** | None (can run in parallel) |
| **Estimated Complexity** | low |
| **Constitution Ref** | `AP-007` (no stub data in production) |

---

## Context

TECH-EMB-002 specifies golden reference outputs for inference validation. This task creates the directory structure and placeholder files. Actual golden data generation requires model inference.

**Why This Matters:**
- Golden references enable automated validation of model loading
- Ensures inference produces correct output after weight loading
- Catches silent failures in weight loading or model configuration

---

## Input Context Files

| Purpose | File Path |
|---------|-----------|
| Tech spec | `docs2/codecheck/embeddingissues/TECH-EMB-002-warm-loading.md` |

---

## Prerequisites

- [ ] None (independent task)

---

## Scope

### In Scope
- Create `tests/fixtures/golden/` directory structure
- Create placeholder files for each model
- Document expected file format

### Out of Scope
- Actual golden data generation (requires model inference)
- Test implementation (Logic Layer - TASK-EMB-015)

---

## Definition of Done

### Directory Structure

```
crates/context-graph-embeddings/tests/fixtures/golden/
    README.md                    # Format documentation
    E1_Semantic/
        test_input.bin           # Placeholder
        golden_output.bin        # Placeholder
        checksum.txt             # Placeholder
    E2_TemporalRecent/
        test_input.bin
        golden_output.bin
        checksum.txt
    E3_TemporalPeriodic/
        ...
    E4_TemporalPositional/
        ...
    E5_Causal/
        ...
    E6_Sparse/
        ...
    E7_Code/
        ...
    E8_Graph/
        ...
    E9_Hdc/
        ...
    E10_Multimodal/
        ...
    E11_Entity/
        ...
    E12_LateInteraction/
        ...
    E13_Splade/
        ...
```

### README.md Content

```markdown
# Golden Reference Test Fixtures

## Purpose

These fixtures contain golden reference outputs for inference validation.
They ensure that model loading produces correct inference results.

## File Format

### test_input.bin
Binary format:
- 4 bytes: dimension count (u32, little-endian)
- N * 4 bytes: f32 values (little-endian)

### golden_output.bin
Same binary format as test_input.bin.

### checksum.txt
SHA-256 checksum of the model weight file that produced this golden output.

## Generating Golden Data

Golden data is generated by running real inference:

```bash
cargo run --bin generate-golden -- --model E1_Semantic --output tests/fixtures/golden/E1_Semantic/
```

## Validation Tolerance

Inference output is validated against golden reference with tolerance:
- FP32: 1e-5 absolute difference
- Mixed precision: 1e-3 absolute difference

## Model Directory Mapping

| Directory | Model | Embedding Dimension |
|-----------|-------|---------------------|
| E1_Semantic | nomic-embed-text-v1.5 | 1024 |
| E2_TemporalRecent | Temporal Recent | 512 |
| E3_TemporalPeriodic | Temporal Periodic | 512 |
| E4_TemporalPositional | Temporal Positional | 512 |
| E5_Causal | Causal SCM | 768 |
| E6_Sparse | Sparse Projection | 1536 |
| E7_Code | CodeBERT | 1536 |
| E8_Graph | MiniLM Graph | 384 |
| E9_Hdc | HDC Binary | 1024 |
| E10_Multimodal | CLIP | 768 |
| E11_Entity | MiniLM Entity | 384 |
| E12_LateInteraction | ColBERT | 128/tok |
| E13_Splade | SPLADE v2 | ~30K sparse |

## Placeholder Status

Until weights are trained and inference is operational, these directories contain
placeholder files. Placeholder files are empty (0 bytes).

Run `find . -size 0` to list all placeholder files.
```

### Constraints
- Placeholder files can be empty or minimal
- Structure must match TECH-EMB-002 specification
- README must document format clearly

### Verification
- Directory structure exists
- README explains format
- 13 model directories present

---

## Files to Create

| Directory/File | Content |
|----------------|---------|
| `tests/fixtures/golden/README.md` | Format documentation |
| `tests/fixtures/golden/E1_Semantic/` | Placeholder directory |
| `tests/fixtures/golden/E2_TemporalRecent/` | Placeholder directory |
| `tests/fixtures/golden/E3_TemporalPeriodic/` | Placeholder directory |
| `tests/fixtures/golden/E4_TemporalPositional/` | Placeholder directory |
| `tests/fixtures/golden/E5_Causal/` | Placeholder directory |
| `tests/fixtures/golden/E6_Sparse/` | Placeholder directory |
| `tests/fixtures/golden/E7_Code/` | Placeholder directory |
| `tests/fixtures/golden/E8_Graph/` | Placeholder directory |
| `tests/fixtures/golden/E9_Hdc/` | Placeholder directory |
| `tests/fixtures/golden/E10_Multimodal/` | Placeholder directory |
| `tests/fixtures/golden/E11_Entity/` | Placeholder directory |
| `tests/fixtures/golden/E12_LateInteraction/` | Placeholder directory |
| `tests/fixtures/golden/E13_Splade/` | Placeholder directory |

---

## Validation Criteria

- [ ] 13 model directories created
- [ ] README.md present and documents format
- [ ] Each directory has placeholder structure

---

## Test Commands

```bash
ls -la /home/cabdru/contextgraph/crates/context-graph-embeddings/tests/fixtures/golden/
find /home/cabdru/contextgraph/crates/context-graph-embeddings/tests/fixtures/golden/ -type d | wc -l
```

---

## Traceability

| Requirement | Tech Spec | Issue |
|-------------|-----------|-------|
| REQ-EMB-003 | TECH-EMB-002 | ISSUE-003 |

---

## Notes

- This task can run in parallel with all other Foundation tasks
- Golden data will be generated after model weights are available
- The tolerance values (1e-5, 1e-3) account for floating-point precision differences

</task_spec>
